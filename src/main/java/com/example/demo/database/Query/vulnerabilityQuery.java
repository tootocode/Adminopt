package com.example.demo.database.Query;

import com.example.demo.entity.InfoEntity;
import com.example.demo.entity.vulnerability;
import sun.awt.X11.XSystemTrayPeer;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

public class vulnerabilityQuery extends AbstractQuery{
    public vulnerabilityQuery(Connection connection) throws SQLException {
        super(connection);
    }

    public List<vulnerability> queryRecord(String sql){
        List<vulnerability> list=new ArrayList<>();
        synchronized (this.connection){
            try{
                ResultSet resultSet = connection.createStatement().executeQuery(sql);
                while(resultSet.next()){
                    vulnerability vulnerability=new vulnerability();
                    vulnerability.setTitle(resultSet.getString("title"));
                    vulnerability.setHanlvl(resultSet.getString("hanlvl"));
                    vulnerability.setDevicetype(resultSet.getString("devicetype"));
                    vulnerability.setDescription(resultSet.getString("description"));
                    vulnerability.setVendors(resultSet.getString("vendor"));
                    //System.out.println(deviceInfo.getDevice()+deviceInfo.getDevicetype()+deviceInfo.getVendor());
                    vulnerability.setTaskdate(resultSet.getString("taskdate"));
                    vulnerability.setIp(resultSet.getString("IP"));
                    vulnerability.setTaskname(resultSet.getString("taskname"));
                    list.add(vulnerability);
                }
            }catch (SQLException e){
                e.printStackTrace();
            }
        }
        return list;
    }
}
